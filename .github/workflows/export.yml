name: Export Calls to Google Doc

on:
  schedule:
    - cron: '*/5 * * * *'  # –ó–∞–ø—É—Å–∫ –∫–∞–∂–¥—ã–µ 5 –º–∏–Ω—É—Ç
  workflow_dispatch:       # –†—É—á–Ω–æ–π –∑–∞–ø—É—Å–∫

jobs:
  export:
    runs-on: ubuntu-latest

    steps:
      - name: üßæ Checkout —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è —Å –ø—Ä–∞–≤–∞–º–∏
        uses: actions/checkout@v3
        with:
          persist-credentials: true
          token: ${{ secrets.GITHUB_TOKEN }}

      - name: üêç –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Python
        uses: actions/setup-python@v4
        with:
          python-version: '3.10'

      - name: üì¶ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
        run: |
          python -m pip install --upgrade pip
          pip install -r requirements.txt

      - name: üöÄ –ó–∞–ø—É—Å–∫ —ç–∫—Å–ø–æ—Ä—Ç–∞ –∑–≤–æ–Ω–∫–æ–≤
        run: python download_jessica_calls_final.py

      - name: üíæ Commit –∏ push last_run.txt
        run: |
          git config --global user.name "GitHub Actions"
          git config --global user.email "actions@github.com"
          git add last_run.txt
          git commit -m "update last_run after export" || echo "‚è≠ –ù–µ—á–µ–≥–æ –∫–æ–º–º–∏—Ç–∏—Ç—å"
          git push origin HEAD:${{ github.ref }}
